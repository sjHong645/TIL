## 06 에러 페이지의 우선순위와 에러 페이지 지정 형태

지금까지 에러 페이지를 지정하는 3가지 방법에 대해 살펴봤다.  
에러 페이지를 여러 방법으로 지정했다면 다음의 우선순위에 따라 사용할 에러 페이지를 선택한다.

1. page 디렉티브의 errorPage 속성에 지정한 에러 페이지를 보여준다.
2. JSP 페이지에서 발생한 Exception 타입이 web.xml 파일의 `<exception-type>`에 지정한 Exception 타입과 동일한 경우 지정한 에러 페이지를 보여준다.
3. 에러 코드가 web.xml 파일의 `<error-code>`에 지정한 에러 코드와 동일한 경우 지정한 에러 페이지를 보여준다.
4. 아무것도 해당하지 않으면 웹 컨테이너가 제공하는 기본 에러 페이지를 보여준다.


## 07 버퍼와 에러 페이지의 관계

버퍼가 다 차면 버퍼의 내용을 웹 브라우저에 전달하는데 처음 버퍼를 플러시(flush)할 때 응답 헤더를 전송한다고 했다.

응답 상태 코드는 응답 헤더 앞에 전송되므로 최초로 버퍼를 플러시(flush)하면 응답 상태 코드가 가장 먼저 전송된다. 

따라서, 버퍼를 최초로 플러시(flush)할 때까지 에러가 발생하지 않으면 웹 브라우저에 200 응답 상태코드가 전송된다.

이러한 이유로 에러 응답 코드와 에러 페이지의 내용을 웹 브라우저에 완전하게 전송하려면 버퍼가 플러시되면 안 된다.  

만약에 버퍼가 플러시 된 이후에 에러가 발생하면 웹 브라우저에 이미 200 응답 상태 코드와 일부 응답 결과 화면이 전송되었기 때문에  
일부 페이지의 내용이 웹 브라우저에 출력되고 그 뒤에 에러 페이지의 내용이 붙게 된다.  

또한 Exception이 발생하면 응답 상태 코드가 500이어야 하는데 이미 200 응답 코드를 보냈기 때문에 웹 브라우저는 정상적으로 응답이 도착했다고 판단한다.

![image](https://user-images.githubusercontent.com/64796257/148726023-5b55de56-f1ea-438b-a16e-542be9cefa36.png)

그래서 버퍼가 플러시된 이후에 Exception이 발생한다면 에러 페이지가 원하는 형태로 출력되지 않는다.  

따라서, Exception이 발생하기 전에 버퍼가 플러시될 가능성이 있다면 버퍼 크기를 늘려서 에러가 발생하기 전에 버퍼가 플러시 되지 않도록 해야 한다.

















